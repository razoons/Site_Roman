<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Ajouter un utilisateur</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>

<h1>Ajouter un utilisateur</h1>
<h2>Attention, ce service ne marche pas puisqu'on n'a pas la possibilité d'envoyer un nouvel utilisateur</h2>

<form id="userForm">
    <label for="nom">Nom</label>
    <input type="text" id="name" name="name" required>

    <label for="email">Username</label>
    <input type="text" id="username" name="username" required>

    <label for="email">Email</label>
    <input type="email" id="email" name="email" required>

    <button type="submit">Enregistrer</button>
</form>

<a href="liste.html">Voir la liste des utilisateurs</a>

<script>
  document.getElementById("userForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const user = {
      name: document.getElementById("name").value,
      email: document.getElementById("email").value,
      username: document.getElementById("username").value
    };

    try {
      const response = await fetch("https://dc222103-19af-4685-a7f1-51da9c4a8488-00-3ijsypv9qlhtt.picard.replit.dev/users", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify(user)
      });

      if (!response.ok) {
        throw new Error("Erreur API");
      }

      const result = await response.json();
      alert("Utilisateur ajouté !");
      console.log(result);

      // reset form
      document.getElementById("userForm").reset();
    } catch (error) {
      console.error(error);
      alert("Erreur lors de l'envoi");
    }
  });
</script>

</body>
</html>


